"0","# We predict on study 3"
"0","indiv.test <- which(study == ""3"")"
"0","# We train on the remaining studies, with pre-tuned parameters"
"0","mint.splsda.stem2 <- mint.splsda(X = X[-c(indiv.test), ], "
"0","                                Y = Y[-c(indiv.test)], "
"0","                                study = droplevels(study[-c(indiv.test)]), "
"0","                                ncomp = 1,  "
"0","                                keepX = 30)"
"0","mint.predict.stem <- predict(mint.splsda.stem2, newdata = X[indiv.test, ], "
"0","                        dist = ""centroids.dist"","
"0","                        study.test = factor(study[indiv.test]))"
"0","# Store class prediction with a model with 1 comp"
"0","indiv.prediction <- mint.predict.stem$class$centroids.dist[, 1]"
"0","# The confusion matrix compares the real subtypes with the predicted subtypes"
"0","conf.mat <- get.confusion_matrix(truth = Y[indiv.test],"
"0","                     predicted = indiv.prediction)"
"0","conf.mat"
"1","          "
"1"," predicted.as.Fibroblast"
"1"," predicted.as.hESC"
"1"," predicted.as.hiPSC"
"1","
Fibroblast"
"1","                       3"
"1","                 0"
"1","                  0"
"1","
hESC      "
"1","                       0"
"1","                 4"
"1","                  4"
"1","
hiPSC     "
"1","                       2"
"1","                 2"
"1","                  6"
"1","
"

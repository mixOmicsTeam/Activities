<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 4 Block PLS-DA on the TCGA case study | Hands-on activities</title>
  <meta name="description" content=" 4 Block PLS-DA on the TCGA case study | Hands-on activities using the R package mixOmics" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content=" 4 Block PLS-DA on the TCGA case study | Hands-on activities" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content=" 4 Block PLS-DA on the TCGA case study | Hands-on activities using the R package mixOmics" />
  <meta name="github-repo" content="mixOmicsTeam/mixOmics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 4 Block PLS-DA on the TCGA case study | Hands-on activities" />
  
  <meta name="twitter:description" content=" 4 Block PLS-DA on the TCGA case study | Hands-on activities using the R package mixOmics" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pls-liver-case.html"/>
<link rel="next" href="mint-stemcell-case.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />










<script>
document.write('<div class="logos"><img src="data:image/jpeg;base64,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" alt="logo" style="position:absolute; top:25px; right:1%; padding:10px;z-index:200;"/></div>')
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preamble</a></li>
<li class="chapter" data-level="1" data-path="pca-multidrug-case.html"><a href="pca-multidrug-case.html"><i class="fa fa-check"></i><b>1</b> PCA on the <code>multidrug</code> study</a><ul>
<li class="chapter" data-level="1.1" data-path="pca-multidrug-case.html"><a href="pca-multidrug-case.html#pca:load"><i class="fa fa-check"></i><b>1.1</b> Load the data</a></li>
<li class="chapter" data-level="1.2" data-path="pca-multidrug-case.html"><a href="pca-multidrug-case.html#pca:ex"><i class="fa fa-check"></i><b>1.2</b> Example: PCA</a><ul>
<li class="chapter" data-level="1.2.1" data-path="pca-multidrug-case.html"><a href="pca-multidrug-case.html#optimal-param-choice"><i class="fa fa-check"></i><b>1.2.1</b> Choose the number of components</a></li>
<li class="chapter" data-level="1.2.2" data-path="pca-multidrug-case.html"><a href="pca-multidrug-case.html#pca-with-fewer-components"><i class="fa fa-check"></i><b>1.2.2</b> PCA with fewer components</a></li>
<li class="chapter" data-level="1.2.3" data-path="pca-multidrug-case.html"><a href="pca-multidrug-case.html#identify-the-informative-variables"><i class="fa fa-check"></i><b>1.2.3</b> Identify the informative variables</a></li>
<li class="chapter" data-level="1.2.4" data-path="pca-multidrug-case.html"><a href="pca-multidrug-case.html#meth-PCA-sample"><i class="fa fa-check"></i><b>1.2.4</b> Sample plots</a></li>
<li class="chapter" data-level="1.2.5" data-path="pca-multidrug-case.html"><a href="pca-multidrug-case.html#variable-plot-correlation-circle-plot"><i class="fa fa-check"></i><b>1.2.5</b> Variable plot: correlation circle plot</a></li>
<li class="chapter" data-level="1.2.6" data-path="pca-multidrug-case.html"><a href="pca-multidrug-case.html#biplot-samples-and-variables"><i class="fa fa-check"></i><b>1.2.6</b> Biplot: samples and variables</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="pca-multidrug-case.html"><a href="pca-multidrug-case.html#spca:ex"><i class="fa fa-check"></i><b>1.3</b> Example: sparse PCA</a><ul>
<li class="chapter" data-level="1.3.1" data-path="pca-multidrug-case.html"><a href="pca-multidrug-case.html#tuning-spca"><i class="fa fa-check"></i><b>1.3.1</b> Choose the number of variables to select</a></li>
<li class="chapter" data-level="1.3.2" data-path="pca-multidrug-case.html"><a href="pca-multidrug-case.html#final-sparse-pca"><i class="fa fa-check"></i><b>1.3.2</b> Final sparse PCA</a></li>
<li class="chapter" data-level="1.3.3" data-path="pca-multidrug-case.html"><a href="pca-multidrug-case.html#sample-and-variable-plots"><i class="fa fa-check"></i><b>1.3.3</b> Sample and variable plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="plsda-srbct-case.html"><a href="plsda-srbct-case.html"><i class="fa fa-check"></i><b>2</b> PLS-DA on the SRBCT case study</a><ul>
<li class="chapter" data-level="2.1" data-path="plsda-srbct-case.html"><a href="plsda-srbct-case.html#plsda:load"><i class="fa fa-check"></i><b>2.1</b> Load the data</a></li>
<li class="chapter" data-level="2.2" data-path="plsda-srbct-case.html"><a href="plsda-srbct-case.html#ex:plsda"><i class="fa fa-check"></i><b>2.2</b> Example: PLS-DA</a><ul>
<li class="chapter" data-level="2.2.1" data-path="plsda-srbct-case.html"><a href="plsda-srbct-case.html#initial-exploration-with-pca"><i class="fa fa-check"></i><b>2.2.1</b> Initial exploration with PCA</a></li>
<li class="chapter" data-level="2.2.2" data-path="plsda-srbct-case.html"><a href="plsda-srbct-case.html#number-of-components-in-pls-da"><i class="fa fa-check"></i><b>2.2.2</b> Number of components in PLS-DA</a></li>
<li class="chapter" data-level="2.2.3" data-path="plsda-srbct-case.html"><a href="plsda-srbct-case.html#PLSDA:final:perf"><i class="fa fa-check"></i><b>2.2.3</b> Final PLS-DA model</a></li>
<li class="chapter" data-level="2.2.4" data-path="plsda-srbct-case.html"><a href="plsda-srbct-case.html#plsda:perf"><i class="fa fa-check"></i><b>2.2.4</b> Classification performance</a></li>
<li class="chapter" data-level="2.2.5" data-path="plsda-srbct-case.html"><a href="plsda-srbct-case.html#ex:plsda:background"><i class="fa fa-check"></i><b>2.2.5</b> Background prediction</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="plsda-srbct-case.html"><a href="plsda-srbct-case.html#ex:splsda"><i class="fa fa-check"></i><b>2.3</b> Example: sPLS-DA</a><ul>
<li class="chapter" data-level="2.3.1" data-path="plsda-srbct-case.html"><a href="plsda-srbct-case.html#plsda:result:numvar"><i class="fa fa-check"></i><b>2.3.1</b> Number of variables to select</a></li>
<li class="chapter" data-level="2.3.2" data-path="plsda-srbct-case.html"><a href="plsda-srbct-case.html#final-splsda-perf"><i class="fa fa-check"></i><b>2.3.2</b> Final model and performance</a></li>
<li class="chapter" data-level="2.3.3" data-path="plsda-srbct-case.html"><a href="plsda-srbct-case.html#plsda:stab"><i class="fa fa-check"></i><b>2.3.3</b> Variable selection and stability</a></li>
<li class="chapter" data-level="2.3.4" data-path="plsda-srbct-case.html"><a href="plsda-srbct-case.html#sample-visualisation"><i class="fa fa-check"></i><b>2.3.4</b> Sample visualisation</a></li>
<li class="chapter" data-level="2.3.5" data-path="plsda-srbct-case.html"><a href="plsda-srbct-case.html#plsda:varplot"><i class="fa fa-check"></i><b>2.3.5</b> Variable visualisation</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="plsda-srbct-case.html"><a href="plsda-srbct-case.html#detour:plsda:predict"><i class="fa fa-check"></i><b>2.4</b> Take a detour: prediction</a></li>
<li class="chapter" data-level="2.5" data-path="plsda-srbct-case.html"><a href="plsda-srbct-case.html#plsda:auroc"><i class="fa fa-check"></i><b>2.5</b> AUROC outputs complement performance evaluation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="pls-liver-case.html"><a href="pls-liver-case.html"><i class="fa fa-check"></i><b>3</b> PLS on the liver toxicity study</a><ul>
<li class="chapter" data-level="3.1" data-path="pls-liver-case.html"><a href="pls-liver-case.html#pls:load"><i class="fa fa-check"></i><b>3.1</b> Load the data</a></li>
<li class="chapter" data-level="3.2" data-path="pls-liver-case.html"><a href="pls-liver-case.html#example-pls1-regression"><i class="fa fa-check"></i><b>3.2</b> Example: PLS1 regression</a><ul>
<li class="chapter" data-level="3.2.1" data-path="pls-liver-case.html"><a href="pls-liver-case.html#number-of-dimensions-using-the-q2-criterion"><i class="fa fa-check"></i><b>3.2.1</b> Number of dimensions using the <span class="math inline">\(Q^2\)</span> criterion</a></li>
<li class="chapter" data-level="3.2.2" data-path="pls-liver-case.html"><a href="pls-liver-case.html#number-of-variables-to-select-in-boldsymbol-x"><i class="fa fa-check"></i><b>3.2.2</b> Number of variables to select in <span class="math inline">\(\boldsymbol X\)</span></a></li>
<li class="chapter" data-level="3.2.3" data-path="pls-liver-case.html"><a href="pls-liver-case.html#final-spls1-model"><i class="fa fa-check"></i><b>3.2.3</b> Final sPLS1 model</a></li>
<li class="chapter" data-level="3.2.4" data-path="pls-liver-case.html"><a href="pls-liver-case.html#pls1:perf"><i class="fa fa-check"></i><b>3.2.4</b> Performance assessment of sPLS1</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="pls-liver-case.html"><a href="pls-liver-case.html#example-pls2-regression"><i class="fa fa-check"></i><b>3.3</b> Example: PLS2 regression</a><ul>
<li class="chapter" data-level="3.3.1" data-path="pls-liver-case.html"><a href="pls-liver-case.html#number-of-dimensions-using-the-q2-criterion-1"><i class="fa fa-check"></i><b>3.3.1</b> Number of dimensions using the <span class="math inline">\(Q^2\)</span> criterion</a></li>
<li class="chapter" data-level="3.3.2" data-path="pls-liver-case.html"><a href="pls-liver-case.html#number-of-variables-to-select-in-both-boldsymbol-x-and-boldsymbol-y"><i class="fa fa-check"></i><b>3.3.2</b> Number of variables to select in both <span class="math inline">\(\boldsymbol X\)</span> and <span class="math inline">\(\boldsymbol Y\)</span></a></li>
<li class="chapter" data-level="3.3.3" data-path="pls-liver-case.html"><a href="pls-liver-case.html#final-spls2"><i class="fa fa-check"></i><b>3.3.3</b> Final sPLS2 model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html"><i class="fa fa-check"></i><b>4</b> Block PLS-DA on the TCGA case study</a><ul>
<li class="chapter" data-level="4.1" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html#diablo:load"><i class="fa fa-check"></i><b>4.1</b> Load the data</a></li>
<li class="chapter" data-level="4.2" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html#parameter-choice"><i class="fa fa-check"></i><b>4.2</b> Parameter choice</a><ul>
<li class="chapter" data-level="4.2.1" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html#diablo:design"><i class="fa fa-check"></i><b>4.2.1</b> Design matrix</a></li>
<li class="chapter" data-level="4.2.2" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html#number-of-components"><i class="fa fa-check"></i><b>4.2.2</b> Number of components</a></li>
<li class="chapter" data-level="4.2.3" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html#diablo:numvar"><i class="fa fa-check"></i><b>4.2.3</b> Number of variables to select</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html#final-model"><i class="fa fa-check"></i><b>4.3</b> Final model</a></li>
<li class="chapter" data-level="4.4" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html#diablo:result:sampleplot"><i class="fa fa-check"></i><b>4.4</b> Sample plots</a><ul>
<li class="chapter" data-level="4.4.1" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html#plotdiablo"><i class="fa fa-check"></i><b>4.4.1</b> <code>plotDiablo</code></a></li>
<li class="chapter" data-level="4.4.2" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html#plotindiv"><i class="fa fa-check"></i><b>4.4.2</b> <code>plotIndiv</code></a></li>
<li class="chapter" data-level="4.4.3" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html#plotarrow"><i class="fa fa-check"></i><b>4.4.3</b> <code>plotArrow</code></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html#diablo:result:varplot"><i class="fa fa-check"></i><b>4.5</b> Variable plots</a><ul>
<li class="chapter" data-level="4.5.1" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html#plotvar"><i class="fa fa-check"></i><b>4.5.1</b> <code>plotVar</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html#circosplot"><i class="fa fa-check"></i><b>4.5.2</b> <code>circosPlot</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html#network"><i class="fa fa-check"></i><b>4.5.3</b> <code>network</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html#plotloadings"><i class="fa fa-check"></i><b>4.5.4</b> <code>plotLoadings</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html#cimdiablo"><i class="fa fa-check"></i><b>4.5.5</b> <code>cimDiablo</code></a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="blockplsda-tcga-case.html"><a href="blockplsda-tcga-case.html#diablo:perf"><i class="fa fa-check"></i><b>4.6</b> Model performance and prediction</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mint-stemcell-case.html"><a href="mint-stemcell-case.html"><i class="fa fa-check"></i><b>5</b> MINT on the stem cell case study</a><ul>
<li class="chapter" data-level="5.1" data-path="mint-stemcell-case.html"><a href="mint-stemcell-case.html#mint:load"><i class="fa fa-check"></i><b>5.1</b> Load the data</a></li>
<li class="chapter" data-level="5.2" data-path="mint-stemcell-case.html"><a href="mint-stemcell-case.html#mint:plsda"><i class="fa fa-check"></i><b>5.2</b> Example: MINT PLS-DA</a></li>
<li class="chapter" data-level="5.3" data-path="mint-stemcell-case.html"><a href="mint-stemcell-case.html#mint:splsda"><i class="fa fa-check"></i><b>5.3</b> Example: MINT sPLS-DA</a><ul>
<li class="chapter" data-level="5.3.1" data-path="mint-stemcell-case.html"><a href="mint-stemcell-case.html#number-of-variables-to-select"><i class="fa fa-check"></i><b>5.3.1</b> Number of variables to select</a></li>
<li class="chapter" data-level="5.3.2" data-path="mint-stemcell-case.html"><a href="mint-stemcell-case.html#final-mint-spls-da-model"><i class="fa fa-check"></i><b>5.3.2</b> Final MINT sPLS-DA model</a></li>
<li class="chapter" data-level="5.3.3" data-path="mint-stemcell-case.html"><a href="mint-stemcell-case.html#mint:result:ncomp"><i class="fa fa-check"></i><b>5.3.3</b> Sample plots</a></li>
<li class="chapter" data-level="5.3.4" data-path="mint-stemcell-case.html"><a href="mint-stemcell-case.html#mint:result:varplot"><i class="fa fa-check"></i><b>5.3.4</b> Variable plots</a></li>
<li class="chapter" data-level="5.3.5" data-path="mint-stemcell-case.html"><a href="mint-stemcell-case.html#mint:result:perf"><i class="fa fa-check"></i><b>5.3.5</b> Classification performance</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="mint-stemcell-case.html"><a href="mint-stemcell-case.html#mint:detour"><i class="fa fa-check"></i><b>5.4</b> Take a detour</a><ul>
<li class="chapter" data-level="5.4.1" data-path="mint-stemcell-case.html"><a href="mint-stemcell-case.html#auc"><i class="fa fa-check"></i><b>5.4.1</b> AUC</a></li>
<li class="chapter" data-level="5.4.2" data-path="mint-stemcell-case.html"><a href="mint-stemcell-case.html#detour:mint:predict"><i class="fa fa-check"></i><b>5.4.2</b> Prediction on an external study</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Hands-on activities</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="blockplsda-tcga-case" class="section level1">
<h1><span class="header-section-number"> 4</span> Block PLS-DA on the TCGA case study</h1>
<p>Human breast cancer is a heterogeneous disease in terms of molecular alterations, cellular composition, and clinical outcome. Breast tumours can be classified into several subtypes, according to their levels of mRNA expression <span class="citation">(Sørlie et al. <a href="#ref-Sor01">2001</a>)</span>. Here we consider a subset of data generated by The Cancer Genome Atlas Network <span class="citation">(Cancer Genome Atlas Network and others <a href="#ref-TCGA12">2012</a>)</span>. For the package, data were normalised, and then drastically prefiltered for illustrative purposes.</p>
<p>The data were divided into a <em>training set</em> with a subset of 150 samples from the mRNA, miRNA and proteomics data, and a <em>test set</em> including 70 samples, but only with mRNA and miRNA data (the proteomics data are missing). The aim of this integrative analysis is to identify a highly correlated multi-omics signature discriminating the breast cancer subtypes Basal, Her2 and LumA.</p>
<p>The <code>breast.TCGA</code> (more details can be found in <code>?breast.TCGA</code>) is a list containing training and test sets of omics data <code>data.train</code> and <code>data.test</code> which include:</p>
<ul>
<li><code>$miRNA</code>: A data frame with 150 (70) rows and 184 columns in the training (test) data set for the miRNA expression levels,</li>
<li><code>$mRNA</code>: A data frame with 150 (70) rows and 520 columns in the training (test) data set for the mRNA expression levels,</li>
<li><code>$protein</code>: A data frame with 150 rows and 142 columns in the training data set for the protein abundance (there are no proteomics in the test set),</li>
<li><code>$subtype</code>: A factor indicating the breast cancer subtypes in the training (for 150 samples) and test sets (for 70 samples).</li>
</ul>
<p>This case study covers an interesting scenario where one omic data set is missing in the test set, but because the method generates a set of components per training data set, we can still assess the prediction or performance evaluation using majority or weighted prediction vote (see Section 4.2).</p>
<div id="diablo:load" class="section level2">
<h2><span class="header-section-number">4.1</span> Load the data</h2>
<p>To illustrate the multiblock sPLS-DA approach, we will integrate the expression levels of miRNA, mRNA and the abundance of proteins while discriminating the subtypes of breast cancer, then predict the subtypes of the samples in the test set.</p>
<p>The input data is first set up as a list of <span class="math inline">\(Q\)</span> matrices <span class="math inline">\(\boldsymbol X_1, \dots, \boldsymbol X_Q\)</span> and a factor indicating the class membership of each sample <span class="math inline">\(\boldsymbol Y\)</span>. Each data frame in <span class="math inline">\(\boldsymbol X\)</span> <em>should be named</em> as we will match these names with the <code>keepX</code> parameter for the sparse method.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" data-line-number="1"><span class="kw">library</span>(mixOmics)</a>
<a class="sourceLine" id="cb131-2" data-line-number="2"><span class="kw">data</span>(breast.TCGA)</a>
<a class="sourceLine" id="cb131-3" data-line-number="3"></a>
<a class="sourceLine" id="cb131-4" data-line-number="4"><span class="co"># Extract training data and name each data frame</span></a>
<a class="sourceLine" id="cb131-5" data-line-number="5"><span class="co"># Store as list</span></a>
<a class="sourceLine" id="cb131-6" data-line-number="6">X &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">mRNA =</span> breast.TCGA<span class="op">$</span>data.train<span class="op">$</span>mrna, </a>
<a class="sourceLine" id="cb131-7" data-line-number="7">          <span class="dt">miRNA =</span> breast.TCGA<span class="op">$</span>data.train<span class="op">$</span>mirna, </a>
<a class="sourceLine" id="cb131-8" data-line-number="8">          <span class="dt">protein =</span> breast.TCGA<span class="op">$</span>data.train<span class="op">$</span>protein)</a>
<a class="sourceLine" id="cb131-9" data-line-number="9"></a>
<a class="sourceLine" id="cb131-10" data-line-number="10"><span class="co"># Outcome</span></a>
<a class="sourceLine" id="cb131-11" data-line-number="11">Y &lt;-<span class="st"> </span>breast.TCGA<span class="op">$</span>data.train<span class="op">$</span>subtype</a>
<a class="sourceLine" id="cb131-12" data-line-number="12"><span class="kw">summary</span>(Y)</a></code></pre></div>
<pre><code>## Basal  Her2  LumA 
##    45    30    75</code></pre>
</div>
<div id="parameter-choice" class="section level2">
<h2><span class="header-section-number">4.2</span> Parameter choice</h2>
<div id="diablo:design" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Design matrix</h3>
<p>The choice of the design can be motivated by different aspects, including:</p>
<ul>
<li><p>Biological apriori knowledge: Should we expect <code>mRNA</code> and <code>miRNA</code> to be highly correlated?</p></li>
<li><p>Analytical aims: As further developed in <span class="citation">Singh et al. (<a href="#ref-Sin19">2019</a>)</span>, a compromise needs to be achieved between a classification and prediction task, and extracting the correlation structure of the data sets. A full design with weights = 1 will favour the latter, but at the expense of classification accuracy, whereas a design with small weights will lead to a highly predictive signature. This pertains to the complexity of the analytical task involved as several constraints are included in the optimisation procedure. For example, here we choose a 0.1 weighted model as we are interested in predicting test samples later in this case study.</p></li>
</ul>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" data-line-number="1">design &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="fl">0.1</span>, <span class="dt">ncol =</span> <span class="kw">length</span>(X), <span class="dt">nrow =</span> <span class="kw">length</span>(X), </a>
<a class="sourceLine" id="cb133-2" data-line-number="2">                <span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="kw">names</span>(X), <span class="kw">names</span>(X)))</a>
<a class="sourceLine" id="cb133-3" data-line-number="3"><span class="kw">diag</span>(design) &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb133-4" data-line-number="4">design </a></code></pre></div>
<pre><code>##         mRNA miRNA protein
## mRNA     0.0   0.1     0.1
## miRNA    0.1   0.0     0.1
## protein  0.1   0.1     0.0</code></pre>
<p>Note however that even with this design, we will still unravel a correlated signature as we require all data sets to explain the same outcome <span class="math inline">\(\boldsymbol y\)</span>, as well as maximising pairs of covariances between data sets.</p>
<ul>
<li>Data-driven option: we could perform regression analyses with PLS to further understand the correlation between data sets. Here for example, we run PLS with one component and calculate the cross-correlations between components associated to each data set:</li>
</ul>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" data-line-number="1">res1.pls.tcga &lt;-<span class="st"> </span><span class="kw">pls</span>(X<span class="op">$</span>mRNA, X<span class="op">$</span>protein, <span class="dt">ncomp =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb135-2" data-line-number="2"><span class="kw">cor</span>(res1.pls.tcga<span class="op">$</span>variates<span class="op">$</span>X, res1.pls.tcga<span class="op">$</span>variates<span class="op">$</span>Y)</a>
<a class="sourceLine" id="cb135-3" data-line-number="3"></a>
<a class="sourceLine" id="cb135-4" data-line-number="4">res2.pls.tcga &lt;-<span class="st"> </span><span class="kw">pls</span>(X<span class="op">$</span>mRNA, X<span class="op">$</span>miRNA, <span class="dt">ncomp =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb135-5" data-line-number="5"><span class="kw">cor</span>(res2.pls.tcga<span class="op">$</span>variates<span class="op">$</span>X, res2.pls.tcga<span class="op">$</span>variates<span class="op">$</span>Y)</a>
<a class="sourceLine" id="cb135-6" data-line-number="6"></a>
<a class="sourceLine" id="cb135-7" data-line-number="7">res3.pls.tcga &lt;-<span class="st"> </span><span class="kw">pls</span>(X<span class="op">$</span>protein, X<span class="op">$</span>miRNA, <span class="dt">ncomp =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb135-8" data-line-number="8"><span class="kw">cor</span>(res3.pls.tcga<span class="op">$</span>variates<span class="op">$</span>X, res3.pls.tcga<span class="op">$</span>variates<span class="op">$</span>Y)</a></code></pre></div>
<pre><code>##           comp1
## comp1 0.9031761
##           comp1
## comp1 0.8456299
##           comp1
## comp1 0.7982008</code></pre>
<p>The data sets taken in a pairwise manner are highly correlated, indicating that a design with weights <span class="math inline">\(\sim 0.8 - 0.9\)</span> could be chosen.</p>
</div>
<div id="number-of-components" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Number of components</h3>
<p>As in the PLS-DA framework presented in Section 3.4, we first fit a <code>block.plsda</code> model without variable selection to assess the global performance of the model and choose the number of components. We run <code>perf()</code> with 10-fold cross validation repeated 10 times for up to 5 components and with our specified design matrix. Similar to PLS-DA, we obtain the performance of the model with respect to the different prediction distances (Figure <a href="blockplsda-tcga-case.html#fig:diablo-perf">4.1</a>):</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" data-line-number="1">diablo.tcga &lt;-<span class="st"> </span><span class="kw">block.plsda</span>(X, Y, <span class="dt">ncomp =</span> <span class="dv">5</span>, <span class="dt">design =</span> design)</a>
<a class="sourceLine" id="cb137-2" data-line-number="2"></a>
<a class="sourceLine" id="cb137-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility, remove for your analyses</span></a>
<a class="sourceLine" id="cb137-4" data-line-number="4">perf.diablo.tcga =<span class="st"> </span><span class="kw">perf</span>(diablo.tcga, <span class="dt">validation =</span> <span class="st">&#39;Mfold&#39;</span>, <span class="dt">folds =</span> <span class="dv">10</span>, <span class="dt">nrepeat =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb137-5" data-line-number="5"></a>
<a class="sourceLine" id="cb137-6" data-line-number="6"><span class="co">#perf.diablo.tcga$error.rate  # Lists the different types of error rates</span></a>
<a class="sourceLine" id="cb137-7" data-line-number="7"></a>
<a class="sourceLine" id="cb137-8" data-line-number="8"><span class="co"># Plot of the error rates based on weighted vote</span></a>
<a class="sourceLine" id="cb137-9" data-line-number="9"><span class="kw">plot</span>(perf.diablo.tcga)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:diablo-perf"></span>
<img src="Figures/DIABLO/diablo-perf-1.png" alt="Choosing the number of components in block.plsda using perf() with 10 × 10-fold CV function in the breast.TCGA study. Classification error rates (overall and balanced, see Section 2.3) are represented on the y-axis with respect to the number of components on the x-axis for each prediction distance presented in PLS-DA in Seciton 3.4 and detailed in Extra reading material 3 from Module 3. Bars show the standard deviation across the 10 repeated folds. The plot shows that the error rate reaches a minimum from 2 to 3 dimensions." width="50%" />
<p class="caption">
Figure 4.1: <strong>Choosing the number of components in <code>block.plsda</code> using <code>perf()</code> with 10 × 10-fold CV function in the <code>breast.TCGA</code> study</strong>. Classification error rates (overall and balanced, see Section 2.3) are represented on the y-axis with respect to the number of components on the x-axis for each prediction distance presented in PLS-DA in Seciton 3.4 and detailed in Extra reading material 3 from Module 3. Bars show the standard deviation across the 10 repeated folds. The plot shows that the error rate reaches a minimum from 2 to 3 dimensions.
</p>
</div>

<p>The performance plot indicates that two components should be sufficient in the final model, and that the centroids distance might lead to better prediction. A balanced error rate (BER) should be considered for further analysis.</p>
<p>The following outputs the optimal number of components according to the prediction distance and type of error rate (overall or balanced), as well as a prediction weighting scheme illustrated further below.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" data-line-number="1">perf.diablo.tcga<span class="op">$</span>choice.ncomp<span class="op">$</span>WeightedVote</a></code></pre></div>
<pre><code>##             max.dist centroids.dist mahalanobis.dist
## Overall.ER         3              2                3
## Overall.BER        3              2                3</code></pre>
<p>Thus, here we choose our final <code>ncomp</code> value:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1">ncomp &lt;-<span class="st"> </span>perf.diablo.tcga<span class="op">$</span>choice.ncomp<span class="op">$</span>WeightedVote[<span class="st">&quot;Overall.BER&quot;</span>, <span class="st">&quot;centroids.dist&quot;</span>]</a></code></pre></div>
</div>
<div id="diablo:numvar" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Number of variables to select</h3>
<p>We then choose the optimal number of variables to select in each data set using the <code>tune.block.splsda</code> function. The function <code>tune()</code> is run with 10-fold cross validation, but repeated only once (<code>nrepeat = 1</code>) for illustrative and computational reasons here. For a thorough tuning process, we advise increasing the <code>nrepeat</code> argument to 10-50, or more.</p>
<p>We choose a <code>keepX</code> grid that is relatively fine at the start, then coarse. If the data sets are easy to classify, the tuning step may indicate the smallest number of variables to separate the sample groups. Hence, we start our grid at the value <code>5</code> to avoid a too small signature that may preclude biological interpretation.</p>
<!-- Zoe, below I produce 2 codes, one that does not use parallel and is not running to compile the book. -->
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" data-line-number="1"><span class="co"># This code may take several min to run, parallelisation is possible</span></a>
<a class="sourceLine" id="cb141-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility with this handbook, remove otherwise</span></a>
<a class="sourceLine" id="cb141-3" data-line-number="3">test.keepX &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">mRNA =</span> <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">9</span>, <span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">5</span>)),</a>
<a class="sourceLine" id="cb141-4" data-line-number="4">                   <span class="dt">miRNA =</span> <span class="kw">c</span>(<span class="dv">5</span><span class="op">:</span><span class="dv">9</span>, <span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb141-5" data-line-number="5">                   <span class="dt">proteomics =</span> <span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">5</span>, <span class="dv">25</span>, <span class="dv">5</span>)))</a>
<a class="sourceLine" id="cb141-6" data-line-number="6"></a>
<a class="sourceLine" id="cb141-7" data-line-number="7">tune.diablo.tcga &lt;-<span class="st"> </span><span class="kw">tune.block.splsda</span>(X, Y, <span class="dt">ncomp =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb141-8" data-line-number="8">                              <span class="dt">test.keepX =</span> test.keepX, <span class="dt">design =</span> design,</a>
<a class="sourceLine" id="cb141-9" data-line-number="9">                              <span class="dt">validation =</span> <span class="st">&#39;Mfold&#39;</span>, <span class="dt">folds =</span> <span class="dv">10</span>, <span class="dt">nrepeat =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb141-10" data-line-number="10">                              <span class="dt">dist =</span> <span class="st">&quot;centroids.dist&quot;</span>)</a></code></pre></div>
<p>Note:</p>
<ul>
<li><em>For fast computation, we can use parallel computing here - this option is also enabled on a laptop or workstation, see <code>?tune.block.splsda</code>.</em></li>
</ul>
<p>The number of features to select on each component is returned and stored for the final model:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" data-line-number="1">list.keepX &lt;-<span class="st"> </span>tune.diablo.tcga<span class="op">$</span>choice.keepX</a>
<a class="sourceLine" id="cb142-2" data-line-number="2">list.keepX</a></code></pre></div>
<pre><code>## $mRNA
## [1]  8 25
## 
## $miRNA
## [1] 14  5
## 
## $protein
## [1] 10  5</code></pre>
<p>Note:</p>
<ul>
<li><em>You can skip any of the tuning steps above, and hard code your chosen <code>ncomp</code> and <code>keepX</code> parameters (as a list for the latter, as shown below).</em></li>
</ul>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" data-line-number="1">list.keepX &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="dt">mRNA =</span> <span class="kw">c</span>(<span class="dv">8</span>, <span class="dv">25</span>), <span class="dt">miRNA =</span> <span class="kw">c</span>(<span class="dv">14</span>,<span class="dv">5</span>), <span class="dt">protein =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">5</span>))</a></code></pre></div>
</div>
</div>
<div id="final-model" class="section level2">
<h2><span class="header-section-number">4.3</span> Final model</h2>
<p>The final multiblock sPLS-DA model includes the tuned parameters and is run as:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" data-line-number="1">diablo.tcga &lt;-<span class="st"> </span><span class="kw">block.splsda</span>(X, Y, <span class="dt">ncomp =</span> ncomp, </a>
<a class="sourceLine" id="cb145-2" data-line-number="2">                            <span class="dt">keepX =</span> list.keepX, <span class="dt">design =</span> design)</a></code></pre></div>
<pre><code>## Design matrix has changed to include Y; each block will be
##             linked to Y.</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" data-line-number="1"><span class="co">#diablo.tcga   # Lists the different functions of interest related to that object</span></a></code></pre></div>
<p>A warning message informs us that the outcome <span class="math inline">\(\boldsymbol Y\)</span> has been included automatically in the design, so that the covariance between each block’s component and the outcome is maximised, as shown in the final design output:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1">diablo.tcga<span class="op">$</span>design</a></code></pre></div>
<pre><code>##         mRNA miRNA protein Y
## mRNA     0.0   0.1     0.1 1
## miRNA    0.1   0.0     0.1 1
## protein  0.1   0.1     0.0 1
## Y        1.0   1.0     1.0 0</code></pre>
<p>The selected variables can be extracted with the function <code>selectVar()</code>, for example in the mRNA block, along with their loading weights (not output here):</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" data-line-number="1"><span class="co"># mRNA variables selected on component 1</span></a>
<a class="sourceLine" id="cb150-2" data-line-number="2"><span class="kw">selectVar</span>(diablo.tcga, <span class="dt">block =</span> <span class="st">&#39;mRNA&#39;</span>, <span class="dt">comp =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><em>Note:</em></p>
<ul>
<li><em>The stability of the selected variables can be extracted from the <code>perf()</code> function, similar to the example given in the PLS-DA analysis (Section 3.4).</em></li>
</ul>
</div>
<div id="diablo:result:sampleplot" class="section level2">
<h2><span class="header-section-number">4.4</span> Sample plots</h2>
<div id="plotdiablo" class="section level3">
<h3><span class="header-section-number">4.4.1</span> <code>plotDiablo</code></h3>
<p><code>plotDiablo()</code> is a diagnostic plot to check whether the correlations between components from each data set were maximised as specified in the design matrix. We specify the dimension to be assessed with the <code>ncomp</code> argument (Figure <a href="blockplsda-tcga-case.html#fig:plot-diablo">4.2</a>).</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" data-line-number="1"><span class="kw">plotDiablo</span>(diablo.tcga, <span class="dt">ncomp =</span> <span class="dv">1</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:plot-diablo"></span>
<img src="Figures/DIABLO/plot-diablo-1.png" alt="Diagnostic plot from multiblock sPLS-DA applied on the breast.TCGA study. Samples are represented based on the specified component (here ncomp = 1) for each data set (mRNA, miRNA and protein). Samples are coloured by breast cancer subtype (, and ) and 95% confidence ellipse plots are represented. The bottom left numbers indicate the correlation coefficients between the first components from each data set. In this example, mRNA expression and protein concentration are highly correlated on the first dimension." width="50%" />
<p class="caption">
Figure 4.2: <strong>Diagnostic plot from multiblock sPLS-DA applied on the <code>breast.TCGA</code> study.</strong> Samples are represented based on the specified component (here <code>ncomp = 1</code>) for each data set (mRNA, miRNA and protein). Samples are coloured by breast cancer subtype (,  and ) and 95% confidence ellipse plots are represented. The bottom left numbers indicate the correlation coefficients between the first components from each data set. In this example, mRNA expression and protein concentration are highly correlated on the first dimension.
</p>
</div>

<p>The plot indicates that the first components from all data sets are highly correlated. The colours and ellipses represent the sample subtypes and indicate the discriminative power of each component to separate the different tumour subtypes. Thus, multiblock sPLS-DA is able to extract a strong correlation structure between data sets, as well as discriminate the breast cancer subtypes on the first component.</p>
</div>
<div id="plotindiv" class="section level3">
<h3><span class="header-section-number">4.4.2</span> <code>plotIndiv</code></h3>
<p>The sample plot with the <code>plotIndiv()</code> function projects each sample into the space spanned by the components from <em>each</em> block, resulting in a series of graphs corresponding to each data set (Figure <a href="blockplsda-tcga-case.html#fig:diablo-plotindiv">4.3</a>). The optional argument <code>blocks</code> can output a specific data set. Ellipse plots are also available (argument <code>ellipse = TRUE</code>).</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" data-line-number="1"><span class="kw">plotIndiv</span>(diablo.tcga, <span class="dt">ind.names =</span> <span class="ot">FALSE</span>, <span class="dt">legend =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb152-2" data-line-number="2">          <span class="dt">title =</span> <span class="st">&#39;TCGA, DIABLO comp 1 - 2&#39;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:diablo-plotindiv"></span>
<img src="Figures/DIABLO/diablo-plotindiv-1.png" alt="Sample plot from multiblock sPLS-DA performed on the breast.TCGA study. The samples are plotted according to their scores on the first 2 components for each data set. Samples are coloured by cancer subtype and are classified into three classes: , and . The plot shows the degree of agreement between the different data sets and the discriminative ability of each data set." width="50%" />
<p class="caption">
Figure 4.3: <strong>Sample plot from multiblock sPLS-DA performed on the <code>breast.TCGA</code> study.</strong> The samples are plotted according to their scores on the first 2 components for each data set. Samples are coloured by cancer subtype and are classified into three classes: ,  and . The plot shows the degree of agreement between the different data sets and the discriminative ability of each data set.
</p>
</div>

<p>This type of graphic allows us to better understand the information extracted from each data set and its discriminative ability. Here we can see that the  group can be difficult to classify in the miRNA data.</p>
<p>Note:</p>
<ul>
<li><em>Additional variants include the argument <code>block = 'average'</code> that averages the components from all blocks to produce a single plot. The argument <code>block='weighted.average'</code> is a weighted average of the components according to their correlation with the components associated with the outcome</em>.</li>
</ul>
</div>
<div id="plotarrow" class="section level3">
<h3><span class="header-section-number">4.4.3</span> <code>plotArrow</code></h3>
<p>In the arrow plot in Figure <a href="blockplsda-tcga-case.html#fig:diablo-plotarrow">4.4</a>, the start of the arrow indicates the centroid between all data sets for a given sample and the tip of the arrow the location of that same sample but in each block. Such graphics highlight the agreement between all data sets at the sample level when modelled with multiblock sPLS-DA.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" data-line-number="1"><span class="kw">plotArrow</span>(diablo.tcga, <span class="dt">ind.names =</span> <span class="ot">FALSE</span>, <span class="dt">legend =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb153-2" data-line-number="2">          <span class="dt">title =</span> <span class="st">&#39;TCGA, DIABLO comp 1 - 2&#39;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:diablo-plotarrow"></span>
<img src="Figures/DIABLO/diablo-plotarrow-1.png" alt="Arrow plot from multiblock sPLS-DA performed on the breast.TCGA study. The samples are projected into the space spanned by the first two components for each data set then overlaid across data sets. The start of the arrow indicates the centroid between all data sets for a given sample and the tip of the arrow the location of the same sample in each block. Arrows further from their centroid indicate some disagreement between the data sets. Samples are coloured by cancer subtype (, and )." width="50%" />
<p class="caption">
Figure 4.4: <strong>Arrow plot from multiblock sPLS-DA performed on the <code>breast.TCGA</code> study.</strong> The samples are projected into the space spanned by the first two components for each data set then overlaid across data sets. The start of the arrow indicates the centroid between all data sets for a given sample and the tip of the arrow the location of the same sample in each block. Arrows further from their centroid indicate some disagreement between the data sets. Samples are coloured by cancer subtype (,  and ).
</p>
</div>

<p>This plot shows that globally, the discrimination of all breast cancer subtypes can be extracted from all data sets, however, there are some dissimilarities at the samples level across data sets (the common information cannot be extracted in the same way across data sets).</p>
</div>
</div>
<div id="diablo:result:varplot" class="section level2">
<h2><span class="header-section-number">4.5</span> Variable plots</h2>
<p>The visualisation of the selected variables is crucial to mine their associations in multiblock sPLS-DA. Here we revisit existing outputs presented in Section 2.2 with further developments for multiple data set integration. All the plots presented provide complementary information for interpreting the results.</p>
<div id="plotvar" class="section level3">
<h3><span class="header-section-number">4.5.1</span> <code>plotVar</code></h3>
<p>The correlation circle plot highlights the contribution of each selected variable to each component. Important variables should be close to the large circle (see Section 2.2). Here, only the variables selected on components 1 and 2 are depicted (across all blocks), see Figure <a href="blockplsda-tcga-case.html#fig:diablo-plotvar">4.5</a>. Clusters of points indicate a strong correlation between variables. For better visibility we chose to hide the variable names.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" data-line-number="1"><span class="kw">plotVar</span>(diablo.tcga, <span class="dt">var.names =</span> <span class="ot">FALSE</span>, <span class="dt">style =</span> <span class="st">&#39;graphics&#39;</span>, <span class="dt">legend =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb154-2" data-line-number="2">        <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">15</span>), <span class="dt">cex =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), </a>
<a class="sourceLine" id="cb154-3" data-line-number="3">        <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&#39;darkorchid&#39;</span>, <span class="st">&#39;brown1&#39;</span>, <span class="st">&#39;lightgreen&#39;</span>),</a>
<a class="sourceLine" id="cb154-4" data-line-number="4">        <span class="dt">title =</span> <span class="st">&#39;TCGA, DIABLO comp 1 - 2&#39;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:diablo-plotvar"></span>
<img src="Figures/DIABLO/diablo-plotvar-1.png" alt="Correlation circle plot from multiblock sPLS-DA performed on the breast.TCGA study. The variable coordinates are defined according to their correlation with the first and second components for each data set. Variable types are indicated with different symbols and colours, and are overlaid on the same plot. The plot highlights the potential associations within and between different variable types when they are important in defining their own component." width="50%" />
<p class="caption">
Figure 4.5: <strong>Correlation circle plot from multiblock sPLS-DA performed on the <code>breast.TCGA</code> study.</strong> The variable coordinates are defined according to their correlation with the first and second components for each data set. Variable types are indicated with different symbols and colours, and are overlaid on the same plot. The plot highlights the potential associations within and between different variable types when they are important in defining their own component.
</p>
</div>

<p>The correlation circle plot shows some positive correlations (between selected  and , between selected  and ) and negative correlations between  and  on component 1. The correlation structure is less obvious on component 2, but we observe some key selected features ( and ) that seem to highly contribute to component 2.</p>
<p>Note:</p>
<ul>
<li><p><em>These results can be further investigated by showing the variable names on this plot (or extracting their coordinates available from the plot saved into an object, see <code>?plotVar</code>), and looking at various outputs from <code>selectVar()</code> and <code>plotLoadings()</code>.</em></p></li>
<li><p><em>You can choose to only show specific variable type names, e.g. <code>var.names = c(FALSE, FALSE, TRUE)</code> (where each argument is assigned to a data set in <span class="math inline">\(\boldsymbol X\)</span>). Here for example, the protein names only would be output.</em></p></li>
</ul>
</div>
<div id="circosplot" class="section level3">
<h3><span class="header-section-number">4.5.2</span> <code>circosPlot</code></h3>
<p>The circos plot represents the correlations between variables of different types, represented on the side quadrants. Several display options are possible, to show within and between connections between blocks, and expression levels of each variable according to each class (argument <code>line = TRUE</code>). The circos plot is built based on a similarity matrix, which was extended to the case of multiple data sets from <span class="citation">González et al. (<a href="#ref-Gon12">2012</a>)</span> (see also Section 2.2 and Extra Reading material from that section). A <code>cutoff</code> argument can be further included to visualise correlation coefficients above this threshold in the multi-omics signature (Figure <a href="blockplsda-tcga-case.html#fig:diablo-circos">4.6</a>). The colours for the blocks and correlation lines can be chosen with <code>color.blocks</code> and <code>color.cor</code> respectively:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" data-line-number="1"><span class="kw">circosPlot</span>(diablo.tcga, <span class="dt">cutoff =</span> <span class="fl">0.7</span>, <span class="dt">line =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb155-2" data-line-number="2">           <span class="dt">color.blocks =</span> <span class="kw">c</span>(<span class="st">&#39;darkorchid&#39;</span>, <span class="st">&#39;brown1&#39;</span>, <span class="st">&#39;lightgreen&#39;</span>),</a>
<a class="sourceLine" id="cb155-3" data-line-number="3">           <span class="dt">color.cor =</span> <span class="kw">c</span>(<span class="st">&quot;chocolate3&quot;</span>,<span class="st">&quot;grey20&quot;</span>), <span class="dt">size.labels =</span> <span class="fl">1.5</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:diablo-circos"></span>
<img src="Figures/DIABLO/diablo-circos-1.png" alt="Circos plot from multiblock sPLS-DA performed on the breast.TCGA study. The plot represents the correlations greater than 0.7 between variables of different types, represented on the side quadrants. The internal connecting lines show the () correlations. The outer lines show the expression levels of each variable in each sample group (, and )." width="50%" />
<p class="caption">
Figure 4.6: <strong>Circos plot from multiblock sPLS-DA performed on the <code>breast.TCGA</code> study.</strong> The plot represents the correlations greater than 0.7 between variables of different types, represented on the side quadrants. The internal connecting lines show the  () correlations. The outer lines show the expression levels of each variable in each sample group (,  and ).
</p>
</div>

<p>The circos plot enables us to visualise cross-correlations between data types, and the nature of these correlations ( or negative). Here we observe that correlations &gt; 0.7 are between a few  and some , whereas the majority of strong (negative) correlations are observed between  and  or . The lines indicating the average expression levels per breast cancer subtype indicate that the selected features are able to discriminate the sample groups.</p>
</div>
<div id="network" class="section level3">
<h3><span class="header-section-number">4.5.3</span> <code>network</code></h3>
<p>Relevance networks, which are also built on the similarity matrix, can also visualise the correlations between the different types of variables. Each colour represents a type of variable. A threshold can also be set using the argument <code>cutoff</code> (Figure <a href="blockplsda-tcga-case.html#fig:diablo-network">4.7</a>). By default the network includes only variables selected on component 1, unless specified in <code>comp</code>.</p>
<p>Note that sometimes the output may not show with Rstudio due to margin issues. We can either use <code>X11()</code> to open a new window, or save the plot as an image using the arguments <code>save</code> and <code>name.save</code>, as we show below. An <code>interactive</code> argument is also available for the <code>cutoff</code> argument, see details in <code>?network</code>.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" data-line-number="1"><span class="co"># X11()   # Opens a new window</span></a>
<a class="sourceLine" id="cb156-2" data-line-number="2"><span class="kw">network</span>(diablo.tcga, <span class="dt">blocks =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), </a>
<a class="sourceLine" id="cb156-3" data-line-number="3">        <span class="dt">cutoff =</span> <span class="fl">0.4</span>,</a>
<a class="sourceLine" id="cb156-4" data-line-number="4">        <span class="dt">color.node =</span> <span class="kw">c</span>(<span class="st">&#39;darkorchid&#39;</span>, <span class="st">&#39;brown1&#39;</span>, <span class="st">&#39;lightgreen&#39;</span>),</a>
<a class="sourceLine" id="cb156-5" data-line-number="5">        <span class="co"># To save the plot, comment out otherwise</span></a>
<a class="sourceLine" id="cb156-6" data-line-number="6">        <span class="dt">save =</span> <span class="st">&#39;pdf&#39;</span>, <span class="dt">name.save =</span> <span class="st">&#39;diablo-network&#39;</span></a>
<a class="sourceLine" id="cb156-7" data-line-number="7">        )</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:diablo-network"></span>
<img src="Figures/DIABLO/diablo-network.pdf" alt="Relevance network for the variables selected by multiblock sPLS-DA performed on the breast.TCGA study on component 1. Each node represents a selected variable with colours indicating their type. The colour of the edges represent positive or negative correlations. Further tweaking of this plot can be obtained, see the help file ?network." width="50%" />
<p class="caption">
Figure 4.7: <strong>Relevance network for the variables selected by multiblock sPLS-DA performed on the <code>breast.TCGA</code> study on component 1.</strong> Each node represents a selected variable with colours indicating their type. The colour of the edges represent positive or negative correlations. Further tweaking of this plot can be obtained, see the help file <code>?network</code>.
</p>
</div>

<p>The relevance network in Figure <a href="blockplsda-tcga-case.html#fig:diablo-network">4.7</a> shows two groups of features of different types. Within each group we observe positive and negative correlations. The visualisation of this plot could be further improved by changing the names of the original features.</p>
<p>Note that the network can be saved in a .gml format to be input into the software Cytoscape, using the R package <code>igraph</code> <span class="citation">(Csardi, Nepusz, and others <a href="#ref-csa06">2006</a>)</span>:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" data-line-number="1"><span class="co"># Not run</span></a>
<a class="sourceLine" id="cb157-2" data-line-number="2"><span class="kw">library</span>(igraph)</a>
<a class="sourceLine" id="cb157-3" data-line-number="3">myNetwork &lt;-<span class="st"> </span><span class="kw">network</span>(diablo.tcga, <span class="dt">blocks =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">cutoff =</span> <span class="fl">0.4</span>)</a>
<a class="sourceLine" id="cb157-4" data-line-number="4"><span class="kw">write.graph</span>(myNetwork<span class="op">$</span>gR, <span class="dt">file =</span> <span class="st">&quot;myNetwork.gml&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;gml&quot;</span>)</a></code></pre></div>
</div>
<div id="plotloadings" class="section level3">
<h3><span class="header-section-number">4.5.4</span> <code>plotLoadings</code></h3>
<p><code>plotLoadings()</code> visualises the loading weights of each selected variable on each component and each data set. The colour indicates the class in which the variable has the maximum level of expression (<code>contrib = 'max'</code>) or minimum (<code>contrib = 'min'</code>), on average (<code>method = 'mean'</code>) or using the median (<code>method = 'median'</code>).</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" data-line-number="1"><span class="kw">plotLoadings</span>(diablo.tcga, <span class="dt">comp =</span> <span class="dv">1</span>, <span class="dt">contrib =</span> <span class="st">&#39;max&#39;</span>, <span class="dt">method =</span> <span class="st">&#39;median&#39;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:diablo-loading"></span>
<img src="Figures/DIABLO/diablo-loading-1.png" alt="Loading plot for the variables selected by multiblock sPLS-DA performed on the breast.TCGA study on component 1. The most important variables (according to the absolute value of their coefficients) are ordered from bottom to top. As this is a supervised analysis, colours indicate the class for which the median expression value is the highest for each feature (variables selected characterise and )." width="50%" />
<p class="caption">
Figure 4.8: <strong>Loading plot for the variables selected by multiblock sPLS-DA performed on the <code>breast.TCGA</code> study on component 1.</strong> The most important variables (according to the absolute value of their coefficients) are ordered from bottom to top. As this is a supervised analysis, colours indicate the class for which the median expression value is the highest for each feature (variables selected characterise  and ).
</p>
</div>

<p>The loading plot shows the multi-omics signature selected on component 1, where each panel represents one data type. The importance of each variable is visualised by the length of the bar (i.e. its loading coefficient value). The combination of the sign of the coefficient (positive / negative) and the colours indicate that component 1 discriminates primarily the  samples vs. the  samples (see the sample plots also). The features selected are highly expressed in one of these two subtypes. One could also plot the second component that discriminates the  samples.</p>
</div>
<div id="cimdiablo" class="section level3">
<h3><span class="header-section-number">4.5.5</span> <code>cimDiablo</code></h3>
<p>The <code>cimDiablo()</code> function is a clustered image map specifically implemented to represent the multi-omics molecular signature expression for each sample. It is very similar to a classical hierarchical clustering (Figure <a href="blockplsda-tcga-case.html#fig:diablo-cim">4.9</a>).</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" data-line-number="1"><span class="kw">cimDiablo</span>(diablo.tcga, <span class="dt">color.blocks =</span> <span class="kw">c</span>(<span class="st">&#39;darkorchid&#39;</span>, <span class="st">&#39;brown1&#39;</span>, <span class="st">&#39;lightgreen&#39;</span>),</a>
<a class="sourceLine" id="cb159-2" data-line-number="2">          <span class="dt">comp =</span> <span class="dv">1</span>, <span class="dt">margin=</span><span class="kw">c</span>(<span class="dv">8</span>,<span class="dv">20</span>), <span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:diablo-cim"></span>
<img src="Figures/DIABLO/diablo-cim-1.png" alt="Clustered Image Map for the variables selected by multiblock sPLS-DA performed on the breast.TCGA study on component 1. By default, Euclidean distance and Complete linkage methods are used. The CIM represents samples in rows (indicated by their breast cancer subtype on the left hand side of the plot) and selected features in columns (indicated by their data type at the top of the plot)." width="70%" />
<p class="caption">
Figure 4.9: <strong>Clustered Image Map for the variables selected by multiblock sPLS-DA performed on the <code>breast.TCGA</code> study on component 1.</strong> By default, Euclidean distance and Complete linkage methods are used. The CIM represents samples in rows (indicated by their breast cancer subtype on the left hand side of the plot) and selected features in columns (indicated by their data type at the top of the plot).
</p>
</div>

<p>According to the CIM, component 1 seems to primarily classify the  samples, with a group of overexpressed  and underexpressed  and . A group of  samples can also be identified due to the overexpression of the same  and .  samples remain quite mixed with the other  samples.</p>
</div>
</div>
<div id="diablo:perf" class="section level2">
<h2><span class="header-section-number">4.6</span> Model performance and prediction</h2>
<p>We assess the performance of the model using 10-fold cross-validation repeated 10 times with the function <code>perf()</code>. The method runs a <code>block.splsda()</code> model on the pre-specified arguments input from our final object <code>diablo.tcga</code> but on cross-validated samples. We then assess the accuracy of the prediction on the left out samples. Since the <code>tune()</code> function was used with the <code>centroid.dist</code> argument, we examine the outputs of the <code>perf()</code> function for that same distance:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility with this handbook, remove otherwise</span></a>
<a class="sourceLine" id="cb160-2" data-line-number="2">perf.diablo.tcga &lt;-<span class="st"> </span><span class="kw">perf</span>(diablo.tcga,  <span class="dt">validation =</span> <span class="st">&#39;Mfold&#39;</span>, <span class="dt">folds =</span> <span class="dv">10</span>, </a>
<a class="sourceLine" id="cb160-3" data-line-number="3">                         <span class="dt">nrepeat =</span> <span class="dv">10</span>, <span class="dt">dist =</span> <span class="st">&#39;centroids.dist&#39;</span>)</a>
<a class="sourceLine" id="cb160-4" data-line-number="4"></a>
<a class="sourceLine" id="cb160-5" data-line-number="5"><span class="co">#perf.diablo.tcga  # Lists the different outputs</span></a></code></pre></div>
<p>We can extract the (balanced) classification error rates globally or overall with
<code>perf.diablo.tcga$error.rate.per.class</code>, the predicted components associated to <span class="math inline">\(\boldsymbol Y\)</span>, or the stability of the selected features with <code>perf.diablo.tcga$features</code>.</p>
<p>Here we look at the different performance assessment schemes specific to multiple data set integration, as mentioned in Section 4.1.</p>
<p>First, we output the performance with the majority vote, that is, since the prediction is based on the components associated to their own data set, we can then weight those predictions across data sets according to a majority vote scheme. Based on the predicted classes, we then extract the classification error rate per class and per component:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" data-line-number="1"><span class="co"># Performance with Majority vote</span></a>
<a class="sourceLine" id="cb161-2" data-line-number="2">perf.diablo.tcga<span class="op">$</span>MajorityVote.error.rate</a></code></pre></div>
<pre><code>## $centroids.dist
##                  comp1      comp2
## Basal       0.02666667 0.04444444
## Her2        0.20666667 0.12333333
## LumA        0.04533333 0.00800000
## Overall.ER  0.07200000 0.04200000
## Overall.BER 0.09288889 0.05859259</code></pre>
<p>The output shows that with the exception of the Basal samples, the classification improves with the addition of the second component.</p>
<p>Another prediction scheme is to weight the classification error rate from each data set according to the correlation between the predicted components and the <span class="math inline">\(\boldsymbol Y\)</span> outcome.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" data-line-number="1"><span class="co"># Performance with Weighted vote</span></a>
<a class="sourceLine" id="cb163-2" data-line-number="2">perf.diablo.tcga<span class="op">$</span>WeightedVote.error.rate</a></code></pre></div>
<pre><code>## $centroids.dist
##                   comp1      comp2
## Basal       0.006666667 0.04444444
## Her2        0.140000000 0.10666667
## LumA        0.045333333 0.00800000
## Overall.ER  0.052666667 0.03866667
## Overall.BER 0.064000000 0.05303704</code></pre>
<p>Compared to the previous majority vote output, we can see that the classification accuracy is slightly better on component 2 for the subtype Her2.</p>
<p>An AUC plot <em>per block</em> is plotted using the function <code>auroc()</code>. We have already mentioned in Section 3.4 that the interpretation of this output may not be particularly insightful in relation to the performance evaluation of our methods, but can complement the statistical analysis. For example, here for the miRNA data set once we have reached component 2 (Figure <a href="blockplsda-tcga-case.html#fig:diablo-auroc">4.10</a>):</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" data-line-number="1">auc.diablo.tcga &lt;-<span class="st"> </span><span class="kw">auroc</span>(diablo.tcga, <span class="dt">roc.block =</span> <span class="st">&quot;miRNA&quot;</span>, <span class="dt">roc.comp =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb165-2" data-line-number="2">                   <span class="dt">print =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:diablo-auroc"></span>
<img src="Figures/DIABLO/diablo-auroc-1.png" alt="ROC and AUC based on multiblock sPLS-DA performed on the breast.TCGA study for the miRNA data set after 2 components. The function calculates the ROC curve and AUC for one class vs. the others. If we set print = TRUE, the Wilcoxon test p-value that assesses the differences between the predicted components from one class vs. the others is output." width="50%" />
<p class="caption">
Figure 4.10: <strong>ROC and AUC based on multiblock sPLS-DA performed on the <code>breast.TCGA</code> study for the miRNA data set after 2 components.</strong> The function calculates the ROC curve and AUC for one class vs. the others. If we set <code>print = TRUE</code>, the Wilcoxon test p-value that assesses the differences between the predicted components from one class vs. the others is output.
</p>
</div>

<p>Figure <a href="blockplsda-tcga-case.html#fig:diablo-auroc">4.10</a> shows that the Her2 subtype is the most difficult to classify with multiblock sPLS-DA compared to the other subtypes.</p>
<p>The <code>predict()</code> function associated with a <code>block.splsda()</code> object predicts the class of samples from an external test set. In our specific case, one data set is missing in the test set but the method can still be applied. We need to ensure the names of the blocks correspond exactly to those from the training set:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" data-line-number="1"><span class="co"># Prepare test set data: here one block (proteins) is missing</span></a>
<a class="sourceLine" id="cb166-2" data-line-number="2">data.test.tcga &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">mRNA =</span> breast.TCGA<span class="op">$</span>data.test<span class="op">$</span>mrna, </a>
<a class="sourceLine" id="cb166-3" data-line-number="3">                      <span class="dt">miRNA =</span> breast.TCGA<span class="op">$</span>data.test<span class="op">$</span>mirna)</a>
<a class="sourceLine" id="cb166-4" data-line-number="4"></a>
<a class="sourceLine" id="cb166-5" data-line-number="5">predict.diablo.tcga &lt;-<span class="st"> </span><span class="kw">predict</span>(diablo.tcga, <span class="dt">newdata =</span> data.test.tcga)</a>
<a class="sourceLine" id="cb166-6" data-line-number="6"><span class="co"># The warning message will inform us that one block is missing</span></a>
<a class="sourceLine" id="cb166-7" data-line-number="7"></a>
<a class="sourceLine" id="cb166-8" data-line-number="8"><span class="co">#predict.diablo # List the different outputs</span></a></code></pre></div>
<p>The following output is a confusion matrix that compares the real subtypes with the predicted subtypes for a 2 component model, for the distance of interest <code>centroids.dist</code> and the prediction scheme <code>WeightedVote</code>:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" data-line-number="1">confusion.mat.tcga &lt;-<span class="st"> </span><span class="kw">get.confusion_matrix</span>(<span class="dt">truth =</span> breast.TCGA<span class="op">$</span>data.test<span class="op">$</span>subtype, </a>
<a class="sourceLine" id="cb167-2" data-line-number="2">                     <span class="dt">predicted =</span> predict.diablo.tcga<span class="op">$</span>WeightedVote<span class="op">$</span>centroids.dist[,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb167-3" data-line-number="3">confusion.mat.tcga</a></code></pre></div>
<pre><code>##       predicted.as.Basal predicted.as.Her2 predicted.as.LumA
## Basal                 20                 1                 0
## Her2                   0                13                 1
## LumA                   0                 3                32</code></pre>
<p>From this table, we see that one Basal and one Her2 sample are wrongly predicted as Her2 and Lum A respectively, and 3 LumA samples are wrongly predicted as Her2. The balanced prediction error rate can be obtained as:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" data-line-number="1"><span class="kw">get.BER</span>(confusion.mat.tcga)</a></code></pre></div>
<pre><code>## [1] 0.06825397</code></pre>
<p>It would be worthwhile at this stage to revisit the chosen design of the multiblock sPLS-DA model to assess the influence of the design on the prediction performance on this test set - even though this back and forth analysis is a biased criterion to choose the design!</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-TCGA12">
<p>Cancer Genome Atlas Network, and others. 2012. “Comprehensive Molecular Portraits of Human Breast Tumours.” <em>Nature</em> 490 (7418). Nature Publishing Group: 61–70.</p>
</div>
<div id="ref-csa06">
<p>Csardi, Gabor, Tamas Nepusz, and others. 2006. “The Igraph Software Package for Complex Network Research.” <em>InterJournal, Complex Systems</em> 1695 (5): 1–9.</p>
</div>
<div id="ref-Gon12">
<p>González, Ignacio, Kim-Anh Lê Cao, Melissa J Davis, Sébastien Déjean, and others. 2012. “Visualising Associations Between Paired ’Omics’ Data Sets.” <em>BioData Mining</em> 5 (1). BioMed Central Ltd: 19.</p>
</div>
<div id="ref-Sin19">
<p>Singh, Amrit, Casey P Shannon, Benoı^t Gautier, Florian Rohart, Michaël Vacher, Scott J Tebbutt, and Kim-Anh Lê Cao. 2019. “DIABLO: An Integrative Approach for Identifying Key Molecular Drivers from Multi-Omics Assays.” <em>Bioinformatics</em> 35 (17). Oxford University Press: 3055–62.</p>
</div>
<div id="ref-Sor01">
<p>Sørlie, Therese, Charles M Perou, Robert Tibshirani, Turid Aas, Stephanie Geisler, Hilde Johnsen, Trevor Hastie, et al. 2001. “Gene Expression Patterns of Breast Carcinomas Distinguish Tumor Subclasses with Clinical Implications.” <em>Proceedings of the National Academy of Sciences</em> 98 (19). National Acad Sciences: 10869–74.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pls-liver-case.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mint-stemcell-case.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-Nintegration.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["hands-on.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
